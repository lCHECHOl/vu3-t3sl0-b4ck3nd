var ot=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var P=(e,t,r)=>(ot(e,t,"read from private field"),r?r.call(e):t.get(e)),ge=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},Se=(e,t,r,n)=>(ot(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);var we=(e,t,r)=>(ot(e,t,"access private method"),r);import{S as er,A as tr,B as _t,C as rr,D as nr,E as D,m as Ke,G as sr,w as re,H as ir,I as Tt,J as or,K as ar,L as lr,z as Ge,e as J,g as te,M as ee,N as ur,O as Ot,P as j,f as Mt,Q as cr,R as dr,T as fr,U as vr,V as mr,d as dt,c as X,a as y,y as ft,t as ae,W as vt,o as Y,_ as mt,l as pr,X as hr,Y as ze,Z as Vt,$ as gr,x as yr,h as ke,a0 as Ae,F as Be,r as at,n as br,a1 as _r,j as St,a2 as Or,a3 as Vr}from"./index-NKNyPgUu.js";import{u as Sr,g as wr,a as Ar}from"./get-product-image.action-M-DTltV-.js";var le,ue,q,ie,je,We,Re,ct,kt,Er=(kt=class extends er{constructor(t,r){super();ge(this,je);ge(this,Re);ge(this,le,void 0);ge(this,ue,void 0);ge(this,q,void 0);ge(this,ie,void 0);Se(this,le,t),this.setOptions(r),this.bindMethods(),we(this,je,We).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var n;const r=this.options;this.options=P(this,le).defaultMutationOptions(t),tr(this.options,r)||P(this,le).getMutationCache().notify({type:"observerOptionsUpdated",mutation:P(this,q),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&_t(r.mutationKey)!==_t(this.options.mutationKey)?this.reset():((n=P(this,q))==null?void 0:n.state.status)==="pending"&&P(this,q).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=P(this,q))==null||t.removeObserver(this)}onMutationUpdate(t){we(this,je,We).call(this),we(this,Re,ct).call(this,t)}getCurrentResult(){return P(this,ue)}reset(){var t;(t=P(this,q))==null||t.removeObserver(this),Se(this,q,void 0),we(this,je,We).call(this),we(this,Re,ct).call(this)}mutate(t,r){var n;return Se(this,ie,r),(n=P(this,q))==null||n.removeObserver(this),Se(this,q,P(this,le).getMutationCache().build(P(this,le),this.options)),P(this,q).addObserver(this),P(this,q).execute(t)}},le=new WeakMap,ue=new WeakMap,q=new WeakMap,ie=new WeakMap,je=new WeakSet,We=function(){var r;const t=((r=P(this,q))==null?void 0:r.state)??rr();Se(this,ue,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Re=new WeakSet,ct=function(t){nr.batch(()=>{var r,n,o,a,m,p,u,c;if(P(this,ie)&&this.hasListeners()){const _=P(this,ue).variables,S=P(this,ue).context;(t==null?void 0:t.type)==="success"?((n=(r=P(this,ie)).onSuccess)==null||n.call(r,t.data,_,S),(a=(o=P(this,ie)).onSettled)==null||a.call(o,t.data,null,_,S)):(t==null?void 0:t.type)==="error"&&((p=(m=P(this,ie)).onError)==null||p.call(m,t.error,_,S),(c=(u=P(this,ie)).onSettled)==null||c.call(u,void 0,t.error,_,S))}this.listeners.forEach(_=>{_(P(this,ue))})})},kt);function jr(e,t){const r=Sr(),n=D(()=>r.defaultMutationOptions(or(e))),o=new Er(r,n.value),a=Ke(o.getCurrentResult()),m=o.subscribe(c=>{sr(a,c)}),p=(c,_)=>{o.mutate(c,_).catch(()=>{})};re(n,()=>{o.setOptions(n.value)}),ar(()=>{m()});const u=ir(Tt(a));return re(()=>a.error,c=>{if(c&&lr(n.value.throwOnError,[c]))throw c}),{...u,mutate:p,mutateAsync:a.mutate,reset:a.reset}}const Ir=async e=>{if(e==="create")return{id:"",title:"",slug:"",description:"",price:0,stock:0,images:[],tags:[],sizes:[],gender:"",user:{}};try{const{data:t}=await Ge.get(`/products/${e}`);return{...t,images:t.images.map(wr)}}catch(t){throw console.log(t),new Error("Error getting products")}},Cr=async e=>{const t=e.id,r=await kr(e.images??[]);return e.images=r,e=Fr(e),t&&t!==""?await Pr(t,e):await Nr(e)},Fr=e=>{var r;const t=((r=e.images)==null?void 0:r.map(n=>n.startsWith("http")?n.split("/").pop()?n:"":n))??[];return delete e.id,delete e.user,e.images=t,e},Pr=async(e,t)=>{try{const{data:r}=await Ge.patch(`/products/${e}`,t);return r}catch(r){throw console.log(r),new Error("Error updating product")}},Nr=async e=>{try{const{data:t}=await Ge.post("/products",e);return t}catch(t){throw console.log(t),new Error("Error updating product")}},kr=async e=>{const t=e.filter(a=>a instanceof File),r=e.filter(a=>typeof a=="string"),n=t.map(async a=>{try{const m=new FormData;m.append("file",a);const{data:p}=await Ge.post("/files/product",m);return p.secureUrl}catch(m){throw console.log(m),new Error("Error uploading image")}}),o=await Promise.all(n);return[...r,...o]};/**
  * vee-validate v4.13.1
  * (c) 2024 Abdelrahman Awad
  * @license MIT
  */function Z(e){return typeof e=="function"}function Ee(e){return e==null}const Ie=e=>e!==null&&!!e&&typeof e=="object"&&!Array.isArray(e);function pt(e){return Number(e)>=0}function Tr(e){return typeof e=="object"&&e!==null}function Mr(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function wt(e){if(!Tr(e)||Mr(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Me(e,t){return Object.keys(t).forEach(r=>{if(wt(t[r])&&wt(e[r])){e[r]||(e[r]={}),Me(e[r],t[r]);return}e[r]=t[r]}),e}function De(e){const t=e.split(".");if(!t.length)return"";let r=String(t[0]);for(let n=1;n<t.length;n++){if(pt(t[n])){r+=`[${t[n]}]`;continue}r+=`.${t[n]}`}return r}const Rr={};function Ur(e){return Rr[e]}function At(e,t,r){typeof r.value=="object"&&(r.value=A(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||t==="__proto__"?Object.defineProperty(e,t,r):e[t]=r.value}function A(e){if(typeof e!="object")return e;var t=0,r,n,o,a=Object.prototype.toString.call(e);if(a==="[object Object]"?o=Object.create(e.__proto__||null):a==="[object Array]"?o=Array(e.length):a==="[object Set]"?(o=new Set,e.forEach(function(m){o.add(A(m))})):a==="[object Map]"?(o=new Map,e.forEach(function(m,p){o.set(A(p),A(m))})):a==="[object Date]"?o=new Date(+e):a==="[object RegExp]"?o=new RegExp(e.source,e.flags):a==="[object DataView]"?o=new e.constructor(A(e.buffer)):a==="[object ArrayBuffer]"?o=e.slice(0):a.slice(-6)==="Array]"&&(o=new e.constructor(e)),o){for(n=Object.getOwnPropertySymbols(e);t<n.length;t++)At(o,n[t],Object.getOwnPropertyDescriptor(e,n[t]));for(t=0,n=Object.getOwnPropertyNames(e);t<n.length;t++)Object.hasOwnProperty.call(o,r=n[t])&&o[r]===e[r]||At(o,r,Object.getOwnPropertyDescriptor(e,r))}return o||e}const Rt=Symbol("vee-validate-form"),$r=typeof window<"u";function zr(e){return Z(e)&&!!e.__locatorRef}function ce(e){return!!e&&Z(e.parse)&&e.__type==="VVTypedSchema"}function Ut(e){return!!e&&Z(e.validate)}function Br(e){return e==="checkbox"||e==="radio"}function Dr(e){return Ie(e)||Array.isArray(e)}function Lr(e){return Array.isArray(e)?e.length===0:Ie(e)&&Object.keys(e).length===0}function He(e){return/^\[.+\]$/i.test(e)}function qr(e){return $t(e)&&e.multiple}function $t(e){return e.tagName==="SELECT"}function Wr(e){return zt(e)&&e.target&&"submit"in e.target}function zt(e){return e?!!(typeof Event<"u"&&Z(Event)&&e instanceof Event||e&&e.srcElement):!1}function de(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,o;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!de(e[n],t[n]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;for(n of e.entries())if(!de(n[1],t.get(n[0])))return!1;return!0}if(Et(e)&&Et(t))return!(e.size!==t.size||e.name!==t.name||e.lastModified!==t.lastModified||e.type!==t.type);if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(n of e.entries())if(!t.has(n[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();for(o=Object.keys(e),r=o.length,n=r;n--!==0;){var a=o[n];if(!de(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function Et(e){return $r?e instanceof File:!1}function ht(e){return He(e)?e.replace(/\[|\]/gi,""):e}function T(e,t,r){return e?He(t)?e[ht(t)]:(t||"").split(/\.|\[(\d+)\]/).filter(Boolean).reduce((o,a)=>Dr(o)&&a in o?o[a]:r,e):r}function R(e,t,r){if(He(t)){e[ht(t)]=r;return}const n=t.split(/\.|\[(\d+)\]/).filter(Boolean);let o=e;for(let a=0;a<n.length;a++){if(a===n.length-1){o[n[a]]=r;return}(!(n[a]in o)||Ee(o[n[a]]))&&(o[n[a]]=pt(n[a+1])?[]:{}),o=o[n[a]]}}function lt(e,t){if(Array.isArray(e)&&pt(t)){e.splice(Number(t),1);return}Ie(e)&&delete e[t]}function jt(e,t){if(He(t)){delete e[ht(t)];return}const r=t.split(/\.|\[(\d+)\]/).filter(Boolean);let n=e;for(let a=0;a<r.length;a++){if(a===r.length-1){lt(n,r[a]);break}if(!(r[a]in n)||Ee(n[r[a]]))break;n=n[r[a]]}const o=r.map((a,m)=>T(e,r.slice(0,m).join(".")));for(let a=o.length-1;a>=0;a--)if(Lr(o[a])){if(a===0){lt(e,r[0]);continue}lt(o[a-1],r[a-1])}}function H(e){return Object.keys(e)}function Kr(e,t=void 0){const r=mr();return(r==null?void 0:r.provides[e])||dr(e,t)}function It(e,t=0){let r=null,n=[];return function(...o){return r&&clearTimeout(r),r=setTimeout(()=>{const a=e(...o);n.forEach(m=>m(a)),n=[]},t),new Promise(a=>n.push(a))}}function Gr(e,t){let r;return async function(...o){const a=e(...o);r=a;const m=await a;return a!==r?m:(r=void 0,t(m,o))}}function Hr({get:e,set:t}){const r=J(A(e()));return re(e,n=>{de(n,r.value)||(r.value=A(n))},{deep:!0}),re(r,n=>{de(n,e())||t(A(n))},{deep:!0}),r}function Ct(e){return Array.isArray(e)?e:e?[e]:[]}function Le(e,t){const r={};for(const n in e)t.includes(n)||(r[n]=e[n]);return r}function Xr(e){let t=null,r=[];return function(...n){const o=ee(()=>{if(t!==o)return;const a=e(...n);r.forEach(m=>m(a)),r=[],t=null});return t=o,new Promise(a=>r.push(a))}}function ut(e){if(Bt(e))return e._value}function Bt(e){return"_value"in e}function Yr(e){return e.type==="number"||e.type==="range"?Number.isNaN(e.valueAsNumber)?e.value:e.valueAsNumber:e.value}function Ft(e){if(!zt(e))return e;const t=e.target;if(Br(t.type)&&Bt(t))return ut(t);if(t.type==="file"&&t.files){const r=Array.from(t.files);return t.multiple?r:r[0]}if(qr(t))return Array.from(t.options).filter(r=>r.selected&&!r.disabled).map(ut);if($t(t)){const r=Array.from(t.options).find(n=>n.selected);return r?ut(r):t.value}return Yr(t)}function Qr(e){const t={};return Object.defineProperty(t,"_$$isNormalized",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e?Ie(e)&&e._$$isNormalized?e:Ie(e)?Object.keys(e).reduce((r,n)=>{const o=Jr(e[n]);return e[n]!==!1&&(r[n]=Pt(o)),r},t):typeof e!="string"?t:e.split("|").reduce((r,n)=>{const o=Zr(n);return o.name&&(r[o.name]=Pt(o.params)),r},t):t}function Jr(e){return e===!0?[]:Array.isArray(e)||Ie(e)?e:[e]}function Pt(e){const t=r=>typeof r=="string"&&r[0]==="@"?xr(r.slice(1)):r;return Array.isArray(e)?e.map(t):e instanceof RegExp?[e]:Object.keys(e).reduce((r,n)=>(r[n]=t(e[n]),r),{})}const Zr=e=>{let t=[];const r=e.split(":")[0];return e.includes(":")&&(t=e.split(":").slice(1).join(":").split(",")),{name:r,params:t}};function xr(e){const t=r=>T(r,e)||r[e];return t.__locatorRef=e,t}const en={generateMessage:({field:e})=>`${e} is not valid.`,bails:!0,validateOnBlur:!0,validateOnChange:!0,validateOnInput:!1,validateOnModelUpdate:!0};let tn=Object.assign({},en);const Te=()=>tn;async function rn(e,t,r={}){const n=r==null?void 0:r.bails,o={name:(r==null?void 0:r.name)||"{field}",rules:t,label:r==null?void 0:r.label,bails:n??!0,formData:(r==null?void 0:r.values)||{}},a=await nn(o,e);return Object.assign(Object.assign({},a),{valid:!a.errors.length})}async function nn(e,t){const r=e.rules;if(ce(r)||Ut(r))return on(t,Object.assign(Object.assign({},e),{rules:r}));if(Z(r)||Array.isArray(r)){const p={field:e.label||e.name,name:e.name,label:e.label,form:e.formData,value:t},u=Array.isArray(r)?r:[r],c=u.length,_=[];for(let S=0;S<c;S++){const U=u[S],I=await U(t,p);if(!(typeof I!="string"&&!Array.isArray(I)&&I)){if(Array.isArray(I))_.push(...I);else{const ne=typeof I=="string"?I:Lt(p);_.push(ne)}if(e.bails)return{errors:_}}}return{errors:_}}const n=Object.assign(Object.assign({},e),{rules:Qr(r)}),o=[],a=Object.keys(n.rules),m=a.length;for(let p=0;p<m;p++){const u=a[p],c=await an(n,t,{name:u,params:n.rules[u]});if(c.error&&(o.push(c.error),e.bails))return{errors:o}}return{errors:o}}function sn(e){return!!e&&e.name==="ValidationError"}function Dt(e){return{__type:"VVTypedSchema",async parse(r,n){var o;try{return{output:await e.validate(r,{abortEarly:!1,context:(n==null?void 0:n.formData)||{}}),errors:[]}}catch(a){if(!sn(a))throw a;if(!(!((o=a.inner)===null||o===void 0)&&o.length)&&a.errors.length)return{errors:[{path:a.path,errors:a.errors}]};const m=a.inner.reduce((p,u)=>{const c=u.path||"";return p[c]||(p[c]={errors:[],path:c}),p[c].errors.push(...u.errors),p},{});return{errors:Object.values(m)}}}}}async function on(e,t){const n=await(ce(t.rules)?t.rules:Dt(t.rules)).parse(e,{formData:t.formData}),o=[];for(const a of n.errors)a.errors.length&&o.push(...a.errors);return{value:n.value,errors:o}}async function an(e,t,r){const n=Ur(r.name);if(!n)throw new Error(`No such validator '${r.name}' exists.`);const o=ln(r.params,e.formData),a={field:e.label||e.name,name:e.name,label:e.label,value:t,form:e.formData,rule:Object.assign(Object.assign({},r),{params:o})},m=await n(t,o,a);return typeof m=="string"?{error:m}:{error:m?void 0:Lt(a)}}function Lt(e){const t=Te().generateMessage;return t?t(e):"Field is invalid"}function ln(e,t){const r=n=>zr(n)?n(t):n;return Array.isArray(e)?e.map(r):Object.keys(e).reduce((n,o)=>(n[o]=r(e[o]),n),{})}async function un(e,t){const n=await(ce(e)?e:Dt(e)).parse(A(t)),o={},a={};for(const m of n.errors){const p=m.errors,u=(m.path||"").replace(/\["(\d+)"\]/g,(c,_)=>`[${_}]`);o[u]={valid:!p.length,errors:p},p.length&&(a[u]=p[0])}return{valid:!n.errors.length,results:o,errors:a,values:n.value,source:"schema"}}async function cn(e,t,r){const o=H(e).map(async c=>{var _,S,U;const I=(_=r==null?void 0:r.names)===null||_===void 0?void 0:_[c],K=await rn(T(t,c),e[c],{name:(I==null?void 0:I.name)||c,label:I==null?void 0:I.label,values:t,bails:(U=(S=r==null?void 0:r.bailsMap)===null||S===void 0?void 0:S[c])!==null&&U!==void 0?U:!0});return Object.assign(Object.assign({},K),{path:c})});let a=!0;const m=await Promise.all(o),p={},u={};for(const c of m)p[c.path]={valid:c.valid,errors:c.errors},c.valid||(a=!1,u[c.path]=c.errors[0]);return{valid:a,results:p,errors:u,source:"schema"}}let dn=0;const qe=["bails","fieldsCount","id","multiple","type","validate"];function qt(e){const t=(e==null?void 0:e.initialValues)||{},r=Object.assign({},j(t)),n=te(e==null?void 0:e.validationSchema);return n&&ce(n)&&Z(n.cast)?A(n.cast(r)||{}):A(r)}function fn(e){var t;const r=dn++;let n=0;const o=J(!1),a=J(!1),m=J(0),p=[],u=Ke(qt(e)),c=J([]),_=J({}),S=J({}),U=Xr(()=>{S.value=c.value.reduce((i,s)=>(i[De(j(s.path))]=s,i),{})});function I(i,s){const l=$(i);if(!l){typeof i=="string"&&(_.value[De(i)]=Ct(s));return}if(typeof i=="string"){const d=De(i);_.value[d]&&delete _.value[d]}l.errors=Ct(s),l.valid=!l.errors.length}function K(i){H(i).forEach(s=>{I(s,i[s])})}e!=null&&e.initialErrors&&K(e.initialErrors);const ne=D(()=>{const i=c.value.reduce((s,l)=>(l.errors.length&&(s[l.path]=l.errors),s),{});return Object.assign(Object.assign({},_.value),i)}),fe=D(()=>H(ne.value).reduce((i,s)=>{const l=ne.value[s];return l!=null&&l.length&&(i[s]=l[0]),i},{})),ye=D(()=>c.value.reduce((i,s)=>(i[s.path]={name:s.path||"",label:s.label||""},i),{})),Ce=D(()=>c.value.reduce((i,s)=>{var l;return i[s.path]=(l=s.bails)!==null&&l!==void 0?l:!0,i},{})),be=Object.assign({},(e==null?void 0:e.initialErrors)||{}),_e=(t=e==null?void 0:e.keepValuesOnUnmount)!==null&&t!==void 0?t:!1,{initialValues:f,originalInitialValues:v,setInitialValues:O}=mn(c,u,e),w=vn(c,u,v,fe),E=D(()=>c.value.reduce((i,s)=>{const l=T(u,s.path);return R(i,s.path,l),i},{})),V=e==null?void 0:e.validationSchema;function k(i,s){var l,d;const g=D(()=>T(f.value,j(i))),b=S.value[j(i)],h=(s==null?void 0:s.type)==="checkbox"||(s==null?void 0:s.type)==="radio";if(b&&h){b.multiple=!0;const G=n++;return Array.isArray(b.id)?b.id.push(G):b.id=[b.id,G],b.fieldsCount++,b.__flags.pendingUnmount[G]=!1,b}const F=D(()=>T(u,j(i))),N=j(i),z=me.findIndex(G=>G===N);z!==-1&&me.splice(z,1);const C=D(()=>{var G,Ne,rt,nt;const st=j(V);if(ce(st))return(Ne=(G=st.describe)===null||G===void 0?void 0:G.call(st,j(i)).required)!==null&&Ne!==void 0?Ne:!1;const it=j(s==null?void 0:s.schema);return ce(it)&&(nt=(rt=it.describe)===null||rt===void 0?void 0:rt.call(it).required)!==null&&nt!==void 0?nt:!1}),B=n++,L=Ke({id:B,path:i,touched:!1,pending:!1,valid:!0,validated:!!(!((l=be[N])===null||l===void 0)&&l.length),required:C,initialValue:g,errors:fr([]),bails:(d=s==null?void 0:s.bails)!==null&&d!==void 0?d:!1,label:s==null?void 0:s.label,type:(s==null?void 0:s.type)||"default",value:F,multiple:!1,__flags:{pendingUnmount:{[B]:!1},pendingReset:!1},fieldsCount:1,validate:s==null?void 0:s.validate,dirty:D(()=>!de(te(F),te(g)))});return c.value.push(L),S.value[N]=L,U(),fe.value[N]&&!be[N]&&ee(()=>{he(N,{mode:"silent"})}),Ot(i)&&re(i,G=>{U();const Ne=A(F.value);S.value[G]=L,ee(()=>{R(u,G,Ne)})}),L}const Q=It(bt,5),Fe=It(bt,5),Ue=Gr(async i=>await(i==="silent"?Q():Fe()),(i,[s])=>{const l=H(se.errorBag.value),g=[...new Set([...H(i.results),...c.value.map(b=>b.path),...l])].sort().reduce((b,h)=>{var F;const N=h,z=$(N)||Xe(N),C=((F=i.results[N])===null||F===void 0?void 0:F.errors)||[],B=j(z==null?void 0:z.path)||N,L=pn({errors:C,valid:!C.length},b.results[B]);return b.results[B]=L,L.valid||(b.errors[B]=L.errors[0]),z&&_.value[B]&&delete _.value[B],z?(z.valid=L.valid,s==="silent"||s==="validated-only"&&!z.validated||I(z,L.errors),b):(I(B,C),b)},{valid:i.valid,results:{},errors:{},source:i.source});return i.values&&(g.values=i.values,g.source=i.source),H(g.results).forEach(b=>{var h;const F=$(b);F&&s!=="silent"&&(s==="validated-only"&&!F.validated||I(F,(h=g.results[b])===null||h===void 0?void 0:h.errors))}),g});function ve(i){c.value.forEach(i)}function $(i){const s=typeof i=="string"?De(i):i;return typeof s=="string"?S.value[s]:s}function Xe(i){return c.value.filter(l=>i.startsWith(l.path)).reduce((l,d)=>l?d.path.length>l.path.length?d:l:d,void 0)}let me=[],Oe;function Ye(i){return me.push(i),Oe||(Oe=ee(()=>{[...me].sort().reverse().forEach(l=>{jt(u,l)}),me=[],Oe=null})),Oe}function M(i){return function(l,d){return function(b){return b instanceof Event&&(b.preventDefault(),b.stopPropagation()),ve(h=>h.touched=!0),o.value=!0,m.value++,Ve().then(h=>{const F=A(u);if(h.valid&&typeof l=="function"){const N=A(E.value);let z=i?N:F;return h.values&&(z=h.source==="schema"?h.values:Object.assign({},z,h.values)),l(z,{evt:b,controlledValues:N,setErrors:K,setFieldError:I,setTouched:Ze,setFieldTouched:$e,setValues:Qe,setFieldValue:oe,resetForm:xe,resetField:gt})}!h.valid&&typeof d=="function"&&d({values:F,evt:b,errors:h.errors,results:h.results})}).then(h=>(o.value=!1,h),h=>{throw o.value=!1,h})}}}const x=M(!1);x.withControlled=M(!0);function Pe(i,s){const l=c.value.findIndex(g=>g.path===i&&(Array.isArray(g.id)?g.id.includes(s):g.id===s)),d=c.value[l];if(!(l===-1||!d)){if(ee(()=>{he(i,{mode:"silent",warn:!1})}),d.multiple&&d.fieldsCount&&d.fieldsCount--,Array.isArray(d.id)){const g=d.id.indexOf(s);g>=0&&d.id.splice(g,1),delete d.__flags.pendingUnmount[s]}(!d.multiple||d.fieldsCount<=0)&&(c.value.splice(l,1),yt(i),U(),delete S.value[i])}}function Wt(i){H(S.value).forEach(s=>{s.startsWith(i)&&delete S.value[s]}),c.value=c.value.filter(s=>!s.path.startsWith(i)),ee(()=>{U()})}const se={formId:r,values:u,controlledValues:E,errorBag:ne,errors:fe,schema:V,submitCount:m,meta:w,isSubmitting:o,isValidating:a,fieldArrays:p,keepValuesOnUnmount:_e,validateSchema:te(V)?Ue:void 0,validate:Ve,setFieldError:I,validateField:he,setFieldValue:oe,setValues:Qe,setErrors:K,setFieldTouched:$e,setTouched:Ze,resetForm:xe,resetField:gt,handleSubmit:x,useFieldModel:Jt,defineInputBinds:Zt,defineComponentBinds:xt,defineField:tt,stageInitialValue:Yt,unsetInitialValue:yt,setFieldInitialValue:et,createPathState:k,getPathState:$,unsetPathValue:Ye,removePathState:Pe,initialValues:f,getAllPathStates:()=>c.value,destroyPath:Wt,isFieldTouched:Gt,isFieldDirty:Ht,isFieldValid:Xt};function oe(i,s,l=!0){const d=A(s),g=typeof i=="string"?i:i.path;$(g)||k(g),R(u,g,d),l&&he(g)}function Kt(i,s=!0){H(u).forEach(l=>{delete u[l]}),H(i).forEach(l=>{oe(l,i[l],!1)}),s&&Ve()}function Qe(i,s=!0){Me(u,i),p.forEach(l=>l&&l.reset()),s&&Ve()}function Je(i,s){const l=$(j(i))||k(i);return D({get(){return l.value},set(d){var g;const b=j(i);oe(b,d,(g=j(s))!==null&&g!==void 0?g:!1)}})}function $e(i,s){const l=$(i);l&&(l.touched=s)}function Gt(i){const s=$(i);return s?s.touched:c.value.filter(l=>l.path.startsWith(i)).some(l=>l.touched)}function Ht(i){const s=$(i);return s?s.dirty:c.value.filter(l=>l.path.startsWith(i)).some(l=>l.dirty)}function Xt(i){const s=$(i);return s?s.valid:c.value.filter(l=>l.path.startsWith(i)).every(l=>l.valid)}function Ze(i){if(typeof i=="boolean"){ve(s=>{s.touched=i});return}H(i).forEach(s=>{$e(s,!!i[s])})}function gt(i,s){var l;const d=s&&"value"in s?s.value:T(f.value,i),g=$(i);g&&(g.__flags.pendingReset=!0),et(i,A(d),!0),oe(i,d,!1),$e(i,(l=s==null?void 0:s.touched)!==null&&l!==void 0?l:!1),I(i,(s==null?void 0:s.errors)||[]),ee(()=>{g&&(g.__flags.pendingReset=!1)})}function xe(i,s){let l=A(i!=null&&i.values?i.values:v.value);l=s!=null&&s.force?l:Me(v.value,l),l=ce(V)&&Z(V.cast)?V.cast(l):l,O(l,{force:s==null?void 0:s.force}),ve(d=>{var g;d.__flags.pendingReset=!0,d.validated=!1,d.touched=((g=i==null?void 0:i.touched)===null||g===void 0?void 0:g[d.path])||!1,oe(d.path,T(l,d.path),!1),I(d.path,void 0)}),s!=null&&s.force?Kt(l,!1):Qe(l,!1),K((i==null?void 0:i.errors)||{}),m.value=(i==null?void 0:i.submitCount)||0,ee(()=>{Ve({mode:"silent"}),ve(d=>{d.__flags.pendingReset=!1})})}async function Ve(i){const s=(i==null?void 0:i.mode)||"force";if(s==="force"&&ve(h=>h.validated=!0),se.validateSchema)return se.validateSchema(s);a.value=!0;const l=await Promise.all(c.value.map(h=>h.validate?h.validate(i).then(F=>({key:h.path,valid:F.valid,errors:F.errors,value:F.value})):Promise.resolve({key:h.path,valid:!0,errors:[],value:void 0})));a.value=!1;const d={},g={},b={};for(const h of l)d[h.key]={valid:h.valid,errors:h.errors},h.value&&R(b,h.key,h.value),h.errors.length&&(g[h.key]=h.errors[0]);return{valid:l.every(h=>h.valid),results:d,errors:g,values:b,source:"fields"}}async function he(i,s){var l;const d=$(i);if(d&&(s==null?void 0:s.mode)!=="silent"&&(d.validated=!0),V){const{results:g}=await Ue((s==null?void 0:s.mode)||"validated-only");return g[i]||{errors:[],valid:!0}}return d!=null&&d.validate?d.validate(s):(!d&&(l=s==null?void 0:s.warn),Promise.resolve({errors:[],valid:!0}))}function yt(i){jt(f.value,i)}function Yt(i,s,l=!1){et(i,s),R(u,i,s),l&&!(e!=null&&e.initialValues)&&R(v.value,i,A(s))}function et(i,s,l=!1){R(f.value,i,A(s)),l&&R(v.value,i,A(s))}async function bt(){const i=te(V);if(!i)return{valid:!0,results:{},errors:{},source:"none"};a.value=!0;const s=Ut(i)||ce(i)?await un(i,u):await cn(i,u,{names:ye.value,bailsMap:Ce.value});return a.value=!1,s}const Qt=x((i,{evt:s})=>{Wr(s)&&s.target.submit()});ur(()=>{if(e!=null&&e.initialErrors&&K(e.initialErrors),e!=null&&e.initialTouched&&Ze(e.initialTouched),e!=null&&e.validateOnMount){Ve();return}se.validateSchema&&se.validateSchema("silent")}),Ot(V)&&re(V,()=>{var i;(i=se.validateSchema)===null||i===void 0||i.call(se,"validated-only")}),vr(Rt,se);function tt(i,s){const l=Z(s)||s==null?void 0:s.label,d=$(j(i))||k(i,{label:l}),g=()=>Z(s)?s(Le(d,qe)):s||{};function b(){var C;d.touched=!0,((C=g().validateOnBlur)!==null&&C!==void 0?C:Te().validateOnBlur)&&he(d.path)}function h(){var C;((C=g().validateOnInput)!==null&&C!==void 0?C:Te().validateOnInput)&&ee(()=>{he(d.path)})}function F(){var C;((C=g().validateOnChange)!==null&&C!==void 0?C:Te().validateOnChange)&&ee(()=>{he(d.path)})}const N=D(()=>{const C={onChange:F,onInput:h,onBlur:b};return Z(s)?Object.assign(Object.assign({},C),s(Le(d,qe)).props||{}):s!=null&&s.props?Object.assign(Object.assign({},C),s.props(Le(d,qe))):C});return[Je(i,()=>{var C,B,L;return(L=(C=g().validateOnModelUpdate)!==null&&C!==void 0?C:(B=Te())===null||B===void 0?void 0:B.validateOnModelUpdate)!==null&&L!==void 0?L:!0}),N]}function Jt(i){return Array.isArray(i)?i.map(s=>Je(s,!0)):Je(i)}function Zt(i,s){const[l,d]=tt(i,s);function g(){d.value.onBlur()}function b(F){const N=Ft(F);oe(j(i),N,!1),d.value.onInput()}function h(F){const N=Ft(F);oe(j(i),N,!1),d.value.onChange()}return D(()=>Object.assign(Object.assign({},d.value),{onBlur:g,onInput:b,onChange:h,value:l.value}))}function xt(i,s){const[l,d]=tt(i,s),g=$(j(i));function b(h){l.value=h}return D(()=>{const h=Z(s)?s(Le(g,qe)):s||{};return Object.assign({[h.model||"modelValue"]:l.value,[`onUpdate:${h.model||"modelValue"}`]:b},d.value)})}return Object.assign(Object.assign({},se),{values:Tt(u),handleReset:()=>xe(),submitForm:Qt})}function vn(e,t,r,n){const o={touched:"some",pending:"some",valid:"every"},a=D(()=>!de(t,te(r)));function m(){const u=e.value;return H(o).reduce((c,_)=>{const S=o[_];return c[_]=u[S](U=>U[_]),c},{})}const p=Ke(m());return Mt(()=>{const u=m();p.touched=u.touched,p.valid=u.valid,p.pending=u.pending}),D(()=>Object.assign(Object.assign({initialValues:te(r)},p),{valid:p.valid&&!H(n.value).length,dirty:a.value}))}function mn(e,t,r){const n=qt(r),o=J(n),a=J(A(n));function m(p,u){u!=null&&u.force?(o.value=A(p),a.value=A(p)):(o.value=Me(A(o.value)||{},A(p)),a.value=Me(A(a.value)||{},A(p))),u!=null&&u.updateFields&&e.value.forEach(c=>{if(c.touched)return;const S=T(o.value,c.path);R(t,c.path,A(S))})}return{initialValues:o,originalInitialValues:a,setInitialValues:m}}function pn(e,t){return t?{valid:e.valid&&t.valid,errors:[...e.errors,...t.errors]}:e}function Nt(e){const t=Kr(Rt,void 0),r=J([]),n=()=>{},o={fields:r,remove:n,push:n,swap:n,insert:n,update:n,replace:n,prepend:n,move:n};if(!t||!te(e))return o;const a=t.fieldArrays.find(f=>te(f.path)===te(e));if(a)return a;let m=0;function p(){return T(t==null?void 0:t.values,j(e),[])||[]}function u(){const f=p();Array.isArray(f)&&(r.value=f.map((v,O)=>_(v,O,r.value)),c())}u();function c(){const f=r.value.length;for(let v=0;v<f;v++){const O=r.value[v];O.isFirst=v===0,O.isLast=v===f-1}}function _(f,v,O){if(O&&!Ee(v)&&O[v])return O[v];const w=m++;return{key:w,value:Hr({get(){const V=T(t==null?void 0:t.values,j(e),[])||[],k=r.value.findIndex(Q=>Q.key===w);return k===-1?f:V[k]},set(V){const k=r.value.findIndex(Q=>Q.key===w);k!==-1&&ye(k,V)}}),isFirst:!1,isLast:!1}}function S(){c(),t==null||t.validate({mode:"silent"})}function U(f){const v=j(e),O=T(t==null?void 0:t.values,v);if(!O||!Array.isArray(O))return;const w=[...O];w.splice(f,1);const E=v+`[${f}]`;t.destroyPath(E),t.unsetInitialValue(E),R(t.values,v,w),r.value.splice(f,1),S()}function I(f){const v=A(f),O=j(e),w=T(t==null?void 0:t.values,O),E=Ee(w)?[]:w;if(!Array.isArray(E))return;const V=[...E];V.push(v),t.stageInitialValue(O+`[${V.length-1}]`,v),R(t.values,O,V),r.value.push(_(v)),S()}function K(f,v){const O=j(e),w=T(t==null?void 0:t.values,O);if(!Array.isArray(w)||!(f in w)||!(v in w))return;const E=[...w],V=[...r.value],k=E[f];E[f]=E[v],E[v]=k;const Q=V[f];V[f]=V[v],V[v]=Q,R(t.values,O,E),r.value=V,c()}function ne(f,v){const O=A(v),w=j(e),E=T(t==null?void 0:t.values,w);if(!Array.isArray(E)||E.length<f)return;const V=[...E],k=[...r.value];V.splice(f,0,O),k.splice(f,0,_(O)),R(t.values,w,V),r.value=k,S()}function fe(f){const v=j(e);t.stageInitialValue(v,f),R(t.values,v,f),u(),S()}function ye(f,v){const O=j(e),w=T(t==null?void 0:t.values,O);!Array.isArray(w)||w.length-1<f||(R(t.values,`${O}[${f}]`,v),t==null||t.validate({mode:"validated-only"}))}function Ce(f){const v=A(f),O=j(e),w=T(t==null?void 0:t.values,O),E=Ee(w)?[]:w;if(!Array.isArray(E))return;const V=[v,...E];R(t.values,O,V),t.stageInitialValue(O+"[0]",v),r.value.unshift(_(v)),S()}function be(f,v){const O=j(e),w=T(t==null?void 0:t.values,O),E=Ee(w)?[]:[...w];if(!Array.isArray(w)||!(f in w)||!(v in w))return;const V=[...r.value],k=V[f];V.splice(f,1),V.splice(v,0,k);const Q=E[f];E.splice(f,1),E.splice(v,0,Q),R(t.values,O,E),r.value=V,S()}const _e={fields:r,remove:U,push:I,swap:K,insert:ne,update:ye,replace:fe,prepend:Ce,move:be};return t.fieldArrays.push(Object.assign({path:e,reset:u},_e)),cr(()=>{const f=t.fieldArrays.findIndex(v=>j(v.path)===j(e));f>=0&&t.fieldArrays.splice(f,1)}),re(p,f=>{const v=r.value.map(O=>O.value);de(f,v)||u()}),_e}const hn=["type","value"],gn={key:0,class:"text-red-500"},yn=dt({__name:"CustomInput",props:{type:{default:"text"},modelValue:{},error:{}},emits:["update:modelValue","blur"],setup(e){return(t,r)=>(Y(),X("div",null,[y("input",{type:t.type,value:t.modelValue,onInput:r[0]||(r[0]=n=>{var o;return t.$emit("update:modelValue",((o=n.target)==null?void 0:o.value)??"")}),onBlur:r[1]||(r[1]=n=>t.$emit("blur")),class:ft(["form-control",{"border-red-500":t.error}])},null,42,hn),t.error?(Y(),X("span",gn,ae(t.error),1)):vt("",!0)]))}}),bn=mt(yn,[["__scopeId","data-v-fe2b0122"]]),_n=["value"],On={key:0,class:"text-red-500"},Vn=dt({__name:"CustomTextarea",props:{modelValue:{},error:{}},emits:["update:modelValue","blur"],setup(e){return(t,r)=>(Y(),X("div",null,[y("textarea",{value:t.modelValue,onInput:r[0]||(r[0]=n=>{var o;return t.$emit("update:modelValue",((o=n.target)==null?void 0:o.value)??"")}),onBlur:r[1]||(r[1]=n=>t.$emit("blur")),class:ft(["form-control",{"border-red-500":t.error}])},null,42,_n),t.error?(Y(),X("span",On,ae(t.error),1)):vt("",!0)]))}}),Sn=mt(Vn,[["__scopeId","data-v-921bcfb3"]]),wn=hr({title:ze().required("Este campo es super importante").min(3,"Mínimo de 3 letras!!!"),slug:ze().required(),description:ze().required(),price:Vt().required(),stock:Vt().required().min(1),gender:ze().required().oneOf(["men","women","kid"])}),An=dt({components:{CustomInput:bn,CustomTextarea:Sn},props:{productId:{type:String,required:!0}},setup(e){const t=gr(),r=pr(),{values:n,defineField:o,errors:a,handleSubmit:m,resetForm:p,meta:u}=fn({validationSchema:wn}),[c,_]=o("title"),[S,U]=o("price"),[I,K]=o("description"),[ne,fe]=o("slug"),[ye,Ce]=o("stock"),[be,_e]=o("gender"),f=J([]),{fields:v,remove:O,push:w}=Nt("sizes"),{fields:E}=Nt("images"),V=m(async M=>{const pe={...M,images:[...M.images,...f.value]};Xe(pe)}),k=M=>{const pe=v.value.map(Pe=>Pe.value);pe.includes(M)?O(pe.indexOf(M)):w(M)},Q=M=>{const x=M.target.files;if(x&&x.length!==0)for(const Pe of x)f.value.push(Pe)},{data:Fe,isError:Ue,isLoading:ve,refetch:$}=Ar({queryKey:["product",e.productId],queryFn:()=>Ir(e.productId),retry:!1}),{mutate:Xe,isSuccess:me,isPending:Oe,data:Ye}=jr({mutationFn:Cr});return Mt(()=>{!ve.value&&Ue.value&&t.replace({name:"products"})}),re(Fe,()=>{Fe&&p({values:Fe.value})},{deep:!0,immediate:!0}),re(me,M=>{M&&(r.success("Updated Product Successfully"),t.replace({name:"products"}),p({values:Ye.value}),f.value=[])}),re(()=>e.productId,()=>{$()}),{values:n,errors:a,meta:u,title:c,titleAttrs:_,price:S,priceAttrs:U,description:I,descriptionAttrs:K,slug:ne,slugAttrs:fe,stock:ye,stockAttrs:Ce,gender:be,genderAttrs:_e,imageFiles:f,sizes:v,images:E,isPending:Oe,allSizes:["XS","S","M","L","XL","XXL"],onSubmit:V,toggleSize:k,hasSize:M=>v.value.map(x=>x.value).includes(M),onFilesChanged:Q,temporalImageUrl:M=>URL.createObjectURL(M)}}}),W=e=>(Or("data-v-6b9ae6fb"),e=e(),Vr(),e),En={class:"bg-white px-5 py-2 rounded"},jn={class:"text-3xl"},In={class:"text-blue-500"},Cn=W(()=>y("hr",{class:"my-4"},null,-1)),Fn={class:"first-col"},Pn={class:"mb-4"},Nn=W(()=>y("label",{for:"title",class:"form-label"},"Título",-1)),kn={class:"mb-4"},Tn=W(()=>y("label",{for:"slug",class:"form-label"},"Slug",-1)),Mn={class:"mb-4"},Rn=W(()=>y("label",{for:"description",class:"form-label"},"Descripción",-1)),Un={class:"flex flex-row gap-3"},$n={class:"mb-4"},zn=W(()=>y("label",{for:"price",class:"form-label"},"Precio",-1)),Bn={class:"mb-4"},Dn=W(()=>y("label",{for:"stock",class:"form-label"},"Inventario",-1)),Ln={class:"mb-4"},qn=W(()=>y("label",{for:"sizes",class:"form-label"},"Tallas",-1)),Wn={class:"flex"},Kn=["onClick"],Gn={class:"first-col"},Hn=W(()=>y("label",{for:"stock",class:"form-label"},"Imágenes",-1)),Xn={class:"flex p-2 overflow-x-auto space-x-8 w-full h-[265px] bg-gray-200 rounded"},Yn=["src","alt"],Qn=["src"],Jn={class:"col-span-2 my-2"},Zn=W(()=>y("label",{for:"image",class:"form-label"},"Subir imagen",-1)),xn={class:"mb-4"},es=W(()=>y("label",{for:"gender",class:"form-label"},"Género",-1)),ts=W(()=>y("option",{value:""},"Seleccione",-1)),rs=W(()=>y("option",{value:"kid"},"Niño",-1)),ns=W(()=>y("option",{value:"women"},"Mujer",-1)),ss=W(()=>y("option",{value:"men"},"Hombre",-1)),is=[ts,rs,ns,ss],os={key:0,class:"text-red-500"},as={class:"my-4 text-right"},ls=["disabled"],us={class:"flex flex-col"},cs={class:"flex flex-col md:flex-row"},ds={class:"w-full md:w-1/2 bg-green-200 p-3"},fs={class:"w-full md:w-1/2 bg-red-200 p-3"},vs={class:"w-full bg-blue-200 p-3"};function ms(e,t,r,n,o,a){const m=St("custom-input"),p=St("custom-textarea");return Y(),X(Be,null,[y("div",En,[y("h1",jn,[yr("Producto: "),y("small",In,ae(e.title),1)]),Cn]),y("form",{onSubmit:t[7]||(t[7]=(...u)=>e.onSubmit&&e.onSubmit(...u)),class:"grid grid-cols-1 sm:grid-cols-2 bg-white px-5 gap-5"},[y("div",Fn,[y("div",Pn,[Nn,ke(m,Ae({modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=u=>e.title=u)},e.titleAttrs,{error:e.errors.title}),null,16,["modelValue","error"])]),y("div",kn,[Tn,ke(m,Ae({modelValue:e.slug,"onUpdate:modelValue":t[1]||(t[1]=u=>e.slug=u)},e.slugAttrs,{error:e.errors.slug}),null,16,["modelValue","error"])]),y("div",Mn,[Rn,ke(p,Ae({modelValue:e.description,"onUpdate:modelValue":t[2]||(t[2]=u=>e.description=u)},e.descriptionAttrs,{error:e.errors.description}),null,16,["modelValue","error"])]),y("div",Un,[y("div",$n,[zn,ke(m,Ae({modelValue:e.price,"onUpdate:modelValue":t[3]||(t[3]=u=>e.price=u),modelModifiers:{number:!0}},e.priceAttrs,{error:e.errors.price,type:"number"}),null,16,["modelValue","error"])]),y("div",Bn,[Dn,ke(m,Ae({modelValue:e.stock,"onUpdate:modelValue":t[4]||(t[4]=u=>e.stock=u),modelModifiers:{number:!0}},e.stockAttrs,{error:e.errors.stock,type:"number"}),null,16,["modelValue","error"])])]),y("div",Ln,[qn,y("div",Wn,[(Y(!0),X(Be,null,at(e.allSizes,u=>(Y(),X("button",{key:u,onClick:c=>e.toggleSize(u),type:"button",class:ft(["p-2 rounded w-14 mr-2 flex-1",{"bg-blue-500 text-white":e.hasSize(u),"bg-blue-100":!e.hasSize(u)}])},ae(u),11,Kn))),128))])])]),y("div",Gn,[Hn,y("div",Xn,[(Y(!0),X(Be,null,at(e.images,u=>(Y(),X("div",{key:u.value,class:"flex-shrink-0"},[y("img",{src:u.value,alt:e.title,class:"w-[250px] h-[250px] rounded"},null,8,Yn)]))),128)),(Y(!0),X(Be,null,at(e.imageFiles,(u,c)=>(Y(),X("div",{key:c,class:"flex-shrink-0"},[y("img",{src:e.temporalImageUrl(u),class:"w-[250px] h-[250px] rounded"},null,8,Qn)]))),128))]),y("div",Jn,[Zn,y("input",{multiple:"",type:"file",id:"image",class:"form-control",accept:"images/*",onChange:t[5]||(t[5]=(...u)=>e.onFilesChanged&&e.onFilesChanged(...u))},null,32)]),y("div",xn,[es,br(y("select",Ae({"onUpdate:modelValue":t[6]||(t[6]=u=>e.gender=u)},e.genderAttrs,{class:["form-control",{"border-red-500":e.errors.gender}]}),is,16),[[_r,e.gender]]),e.errors.gender?(Y(),X("span",os,ae(e.errors.gender),1)):vt("",!0)]),y("div",as,[y("button",{disabled:e.isPending,type:"submit",class:"disabled:bg-gray-300 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Guardar ",8,ls)])])],32),y("div",us,[y("div",cs,[y("div",ds,ae(e.values),1),y("div",fs,ae(e.errors),1)]),y("div",null,[y("div",vs,ae(e.meta),1)])])],64)}const ys=mt(An,[["render",ms],["__scopeId","data-v-6b9ae6fb"]]);export{ys as default};
